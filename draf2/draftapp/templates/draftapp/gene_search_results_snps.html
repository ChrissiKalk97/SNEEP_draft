{% extends "draftapp/base.html" %}
{% block body%}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<link rel="stylesheet" type= "text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css" />
<script type="text/javascript" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script type = "text/javascript">
    $(document).ready(function(){
        $('#table').DataTable({
          dom: 'Bfrtip',
        buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
        ]
        });
        lengthMenu: [
            [10, 25, 50, -1],
            [10, 25, 50, 'All'],
          ];
    });
    
  </script>
  {% if gene_dict %} 
     <h3>Gene query results:</h3> 
   <table id = "table" class = "table table-bordered">
        <thead class = "alert-success">
            <tr>
              <th>Gene name</th>
              <th>Ensembl id</th>
              <th>associated rSNP</th>
              <th>rSNP position</th>
              <th>GWAS traits associated to rSNPs</th>
              <th>Enhancers</th>
              <th>Transcription factors</th>
              
            </tr>
        </thead>
        <tbody>
          
          {% for gene, snps in gene_dict.items %}
            {% for snp in snps %}
            <tr>
              <td>{{gene.genesymbol}}</td>
              <td>{{gene.geneid}}</td>
              <td><a href="{% url 'draftapp:snp_detail' snp.rsid %}">{{snp.rsid}}</a></td>
              <td>{{snp.chr}}:{{snp.start}}-{{snp.end}}</td>
              <td>{% for exs in snp.enhancersxsnpsrsid.all %}
                    {% if exs == snp.enhancersxsnpsrsid.last%} 
                      {{exs.efoid.efoid.name}}
                    {% else %} 
                      {{exs.efoid.efoid.name}}, 
                    {% endif %}
                  {% endfor %}
                </td>
                <td>{% for exs in snp.enhancersxsnpsrsid.all %}
                      {% if exs == snp.enhancersxsnpsrsid.last%} 
                        {{exs.enhancerid.enhancerid}}
                      {% else %} 
                        {{exs.enhancerid.enhancerid}}, 
                      {% endif %}
                    {% endfor %}
                  </td>
              <td>{% for tfsXsnp in snp.Tfsxsnps_rsId.all %}
                    {% if tfsXsnp == snp.Tfsxsnps_rsId.last%} 
                      {{tfsXsnp.tfid.name}}
                    {% else %} 
                      {{tfsXsnp.tfid.name}}, 
                    {% endif %}
                  {% endfor %}
              </td>
            </tr>
               
            {% endfor %}
          {% endfor %}
        </tbody>
    </table>
  



  {% else %}
      <h3>This Gene is not investigated by us!</h3>
  {% endif %}
  

{% endblock %}

